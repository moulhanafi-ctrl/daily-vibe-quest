# End-to-End Manual Test Results
**Date:** January 22, 2025  
**Tester:** QA Team  
**App Version:** 2025-10-15-chat-fix  
**Environment:** Production

## Test Summary
| Test Suite | Total Tests | Passed | Failed | Blocked | Pass Rate |
|------------|-------------|--------|--------|---------|-----------|
| Authentication | 12 | 0 | 0 | 0 | 0% |
| Onboarding | 8 | 0 | 0 | 0 | 0% |
| Daily Check-in & Journal | 10 | 0 | 0 | 0 | 0% |
| Chat & Moderation | 15 | 0 | 0 | 0 | 0% |
| Store & Subscriptions | 12 | 0 | 0 | 0 | 0% |
| Account Management | 8 | 0 | 0 | 0 | 0% |
| **TOTAL** | **65** | **0** | **0** | **0** | **0%** |

---

## 1. Authentication Flow (P0)

### Test Case 1.1: User Sign-Up
**Priority:** P0  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Navigate to `/auth`
2. Click "Don't have an account? Sign up"
3. Enter username (min 3 chars, alphanumeric)
4. Select age group (child/teen/adult)
5. Enter valid email address
6. Enter password with:
   - Min 12 characters
   - 1 uppercase letter
   - 1 lowercase letter
   - 1 number
   - 1 special symbol
7. Submit form

**Expected Results:**
- Password strength indicator shows "Strong" (green)
- Password validation errors clear when requirements met
- Toast notification: "Account created! Let's personalize your experience."
- Redirect to `/onboarding`
- User record created in `profiles` table with `username`, `age_group`

**Actual Results:**
- [ ] Password strength indicator works
- [ ] All validation messages clear
- [ ] Success toast appears
- [ ] Redirects to onboarding
- [ ] Profile created in database

**Analytics Event:** `onboarding_started`

---

### Test Case 1.2: User Login
**Priority:** P0  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Navigate to `/auth`
2. Enter registered email
3. Enter correct password
4. Click "Sign In"

**Expected Results:**
- Toast: "Welcome back, {username}!"
- Redirect to `/dashboard` if onboarding complete
- Redirect to `/onboarding` if incomplete
- Session stored in localStorage
- Auth state change event fires

**Actual Results:**
- [ ] Correct welcome message
- [ ] Redirects to appropriate page
- [ ] Session persists on refresh

**Analytics Event:** `user_login`

---

### Test Case 1.3: Password Strength Validation
**Priority:** P0  
**Status:** ‚è≥ NOT TESTED

**Test Data:**
- Weak: `password` (should fail)
- Moderate: `Password123` (should warn)
- Strong: `P@ssw0rd!2025` (should pass)

**Expected Results:**
- Weak passwords show red indicator and prevent signup
- Moderate passwords show yellow indicator
- Strong passwords show green indicator and enable signup button
- Score < 3 prevents submission

**Actual Results:**
- [ ] Weak password blocked
- [ ] Moderate password warned
- [ ] Strong password accepted

---

### Test Case 1.4: Duplicate Email Prevention
**Priority:** P1  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Attempt to sign up with existing email
2. Submit form

**Expected Results:**
- Error toast: "User already registered" (or similar)
- No new account created
- User remains on auth page

**Actual Results:**
- [ ] Appropriate error message shown
- [ ] No duplicate account created

---

### Test Case 1.5: Password Reset Flow
**Priority:** P1  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. On login page, click "Forgot your password?"
2. Navigate to `/auth/recovery`
3. Enter registered email
4. Click "Send Reset Link"
5. Check email for reset link
6. Click link and set new password
7. Submit new password

**Expected Results:**
- Toast: "Check your email. We've sent you a password reset link."
- Email received with reset link
- Link redirects to `/auth/reset-password`
- New password accepted
- Can login with new password

**Actual Results:**
- [ ] Email received
- [ ] Reset link works
- [ ] New password set successfully
- [ ] Login works with new password

---

### Test Case 1.6: Logout
**Priority:** P0  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. From Dashboard, click "Sign Out" button
2. Confirm logout

**Expected Results:**
- Toast: "Signed out successfully"
- Redirect to `/` (homepage)
- Session cleared from localStorage
- Cannot access `/dashboard` without re-login

**Actual Results:**
- [ ] Success message shown
- [ ] Redirects to home
- [ ] Session cleared
- [ ] Protected routes inaccessible

---

### Test Case 1.7: Private Browsing Detection (Safari)
**Priority:** P2  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Open Safari in Private Browsing mode
2. Navigate to `/auth`
3. Attempt to sign in or sign up

**Expected Results:**
- Warning toast: "Private Browsing Detected. Please use standard browsing mode for login to work properly."
- Auth buttons disabled

**Actual Results:**
- [ ] Warning shown
- [ ] Buttons disabled appropriately

---

### Test Case 1.8: Email Redirect Configuration
**Priority:** P0  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Sign up with new email
2. Check that `emailRedirectTo` is set to `${window.location.origin}/onboarding`

**Expected Results:**
- Redirect URL includes correct origin
- After email confirmation, redirects to onboarding

**Actual Results:**
- [ ] Correct redirect URL configured
- [ ] Email confirmation redirects properly

---

### Test Case 1.9: Session Persistence
**Priority:** P0  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Login to app
2. Refresh browser
3. Close and reopen browser
4. Navigate to protected route

**Expected Results:**
- Session persists across page refresh
- Session persists after browser close/reopen
- User remains logged in
- No re-authentication required

**Actual Results:**
- [ ] Session survives refresh
- [ ] Session survives browser reopen
- [ ] Auto-redirects to dashboard

---

### Test Case 1.10: Concurrent Login Sessions
**Priority:** P2  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Login on Device A
2. Login with same account on Device B
3. Verify both sessions work
4. Logout from Device A
5. Check Device B session

**Expected Results:**
- Multiple sessions allowed
- Logout on one device doesn't affect other
- Both sessions can access protected routes

**Actual Results:**
- [ ] Multiple sessions work
- [ ] Independent session management

---

### Test Case 1.11: Invalid Credentials
**Priority:** P1  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Attempt login with wrong password
2. Attempt login with non-existent email

**Expected Results:**
- Error toast: "Invalid login credentials" (or similar)
- User remains on auth page
- No session created

**Actual Results:**
- [ ] Appropriate error shown
- [ ] No session created

---

### Test Case 1.12: Age Group Selection
**Priority:** P0  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. During signup, select each age group (child/teen/adult)
2. Complete signup
3. Verify age group saved correctly

**Expected Results:**
- Age group radio buttons work
- Selected age group saved to profile
- Appropriate content shown based on age group

**Actual Results:**
- [ ] All age groups selectable
- [ ] Age group persists in database
- [ ] Age-appropriate content displayed

---

## 2. Onboarding Flow (P0)

### Test Case 2.1: Complete Onboarding (Adult)
**Priority:** P0  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Sign up as adult user
2. Complete welcome screen
3. Enter basic info (birthday, timezone)
4. Select 3 focus areas
5. Complete deep dive questions
6. Confirm selections

**Expected Results:**
- Welcome screen shows overview
- Can select birthday and timezone
- Can select up to 3 focus areas
- Focus areas saved to `selected_focus_areas` array
- Deep dive questions appropriate for adult
- Redirect to `/dashboard` after completion
- Toast: success message

**Actual Results:**
- [ ] All steps complete
- [ ] Focus areas saved
- [ ] Redirects to dashboard
- [ ] Profile fully populated

**Analytics Event:** `onboarding_completed`

---

### Test Case 2.2: Focus Area Selection Validation
**Priority:** P0  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. At focus area step, select 0 areas
2. Try to continue
3. Select 1 area and continue
4. Select 3 areas and continue
5. Try to select 4 areas

**Expected Results:**
- Cannot proceed with 0 focus areas
- Can proceed with 1-3 focus areas
- Cannot select more than 3 areas
- Error message shown if limits violated

**Actual Results:**
- [ ] Min/max validation works
- [ ] Error messages clear
- [ ] Can proceed with valid selection

---

### Test Case 2.3: Skip Deep Dive Questions
**Priority:** P2  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Reach deep dive step
2. Click "Skip" or "Continue" without answering
3. Complete onboarding

**Expected Results:**
- Can skip optional questions
- Still completes onboarding successfully
- No required field errors

**Actual Results:**
- [ ] Skip functionality works
- [ ] Onboarding completes

---

### Test Case 2.4: Onboarding for Minor (Child/Teen)
**Priority:** P0  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Sign up with age group "child" or "teen"
2. Complete onboarding
3. Verify parent verification flow triggers

**Expected Results:**
- Age-appropriate content shown
- Parent verification required
- Redirect to `/parent-verification` after onboarding
- Cannot access certain features until verified

**Actual Results:**
- [ ] Age-appropriate content
- [ ] Parent verification triggered
- [ ] Feature access restricted

---

### Test Case 2.5: Onboarding Progress State
**Priority:** P1  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Start onboarding
2. Complete 2 steps
3. Refresh browser
4. Log out and log back in

**Expected Results:**
- Progress persists across refresh
- Returns to correct step after re-login
- Can complete remaining steps

**Actual Results:**
- [ ] Progress saved
- [ ] Correct step resumed
- [ ] Completes successfully

---

### Test Case 2.6: Language Selection During Onboarding
**Priority:** P1  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. After signup, check if redirected to `/welcome/language`
2. Select language (EN/ES/FR/AR)
3. Continue to onboarding

**Expected Results:**
- Language picker shown if no language set
- Selected language saved to profile
- UI updates to selected language
- Can change language later in settings

**Actual Results:**
- [ ] Language picker works
- [ ] Language persists
- [ ] UI updates correctly

---

### Test Case 2.7: First Check-in Redirect
**Priority:** P0  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Complete onboarding
2. Navigate to dashboard
3. Complete first mood check-in
4. Submit check-in

**Expected Results:**
- After first check-in, redirected to `/journal?first_entry=true`
- Toast: "Great start! üéâ Now let's capture your thoughts."
- Journal page pre-opens composer

**Actual Results:**
- [ ] Redirects to journal
- [ ] Toast message shown
- [ ] Composer auto-opens

**Analytics Event:** `first_checkin_completed`

---

### Test Case 2.8: Focus Area Update Post-Onboarding
**Priority:** P1  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Complete onboarding with initial focus areas
2. Go to Settings > Profile
3. Click "Update Focus Areas"
4. Change selections
5. Save changes

**Expected Results:**
- Focus Areas popup opens
- Can modify selections
- Changes save successfully
- Updated focus areas reflect in chat rooms and AI suggestions

**Actual Results:**
- [ ] Popup works
- [ ] Changes save
- [ ] Updates reflected throughout app

---

## 3. Daily Check-in & Journal (P0)

### Test Case 3.1: First Mood Check-in
**Priority:** P0  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Login as new user after onboarding
2. Navigate to Dashboard > Check-in tab
3. Select mood (1-5)
4. Optionally add notes
5. Submit check-in

**Expected Results:**
- Mood selector shows 1-5 range
- Optional notes field (max length enforced)
- Check-in saved to `mood_checkins` table
- Streak badge updates
- Redirect to journal with `?first_checkin=true`

**Actual Results:**
- [ ] Mood selector works
- [ ] Check-in saves
- [ ] Streak updates
- [ ] Redirects to journal

**Analytics Event:** `checkin_submitted`

---

### Test Case 3.2: Journal Entry Creation
**Priority:** P0  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Navigate to `/journal`
2. Click "New Entry" button
3. Write entry content
4. Optionally select from prompts
5. Save entry

**Expected Results:**
- Composer opens
- Can write free-form text
- Can select pre-written prompts
- Entry saved to `journal_entries` table
- Entry appears in list view
- Privacy notice shown for minors

**Actual Results:**
- [ ] Composer opens
- [ ] Entry saves
- [ ] Appears in list
- [ ] Privacy notice shown (minors)

**Analytics Event:** `journal_entry_created`

---

### Test Case 3.3: Voice Recording in Journal
**Priority:** P2  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Open journal composer
2. Click voice recording button
3. Grant microphone permission
4. Record audio (30 seconds)
5. Stop recording
6. Transcribe and save

**Expected Results:**
- Voice recorder component appears
- Browser requests microphone permission
- Audio records successfully
- Transcription occurs via edge function
- Transcribed text appears in composer
- Can edit transcribed text before saving

**Actual Results:**
- [ ] Recording works
- [ ] Transcription successful
- [ ] Text editable

---

### Test Case 3.4: Journal Export
**Priority:** P1  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Create multiple journal entries
2. Navigate to Journal page
3. Click "Export" button
4. Select format (PDF/JSON)
5. Download file

**Expected Results:**
- Export button visible
- Format selection dialog appears
- Export edge function called
- File downloads successfully
- Contains all user's entries with correct formatting

**Actual Results:**
- [ ] Export button works
- [ ] File downloads
- [ ] Content correct and complete

**Analytics Event:** `journal_exported`

---

### Test Case 3.5: Daily Reflection Prompt
**Priority:** P1  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Login at start of day
2. Check for daily reflection modal
3. Select prompt or dismiss
4. If selected, navigate to journal

**Expected Results:**
- Modal appears once per day
- Shows AI-generated or curated prompt
- Can dismiss without penalty
- Selecting prompt opens journal with prompt text
- Modal doesn't reappear same day

**Actual Results:**
- [ ] Modal shows once daily
- [ ] Prompt relevant
- [ ] Dismissal works
- [ ] Selection opens journal

---

### Test Case 3.6: Mood History Chart
**Priority:** P1  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Complete check-ins over 7+ days
2. Navigate to Dashboard > History tab
3. View weekly vibe chart

**Expected Results:**
- Chart displays last 7 days
- Mood scores (1-5) plotted correctly
- X-axis shows dates
- Y-axis shows mood scale
- Data points accurate

**Actual Results:**
- [ ] Chart displays
- [ ] Data accurate
- [ ] Dates correct

---

### Test Case 3.7: Streak Tracking
**Priority:** P1  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Complete check-ins on consecutive days
2. View streak badge on dashboard
3. Skip a day
4. Check if streak resets

**Expected Results:**
- Streak counter increases daily
- Badge displays current streak
- Missing a day resets to 0
- Longest streak tracked separately

**Actual Results:**
- [ ] Streak increments
- [ ] Reset on skip works
- [ ] Longest streak tracked

---

### Test Case 3.8: AI Suggestions Based on Mood
**Priority:** P1  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Complete check-in with low mood (1-2)
2. Navigate to Dashboard > AI tab
3. View AI suggestions

**Expected Results:**
- AI suggestions generated based on mood and focus areas
- Suggestions appropriate for current mood
- Can view multiple suggestions
- Suggestions actionable

**Actual Results:**
- [ ] Suggestions generated
- [ ] Context-appropriate
- [ ] Actionable content

**Analytics Event:** `ai_suggestion_viewed`

---

### Test Case 3.9: Mindful AI Assistant
**Priority:** P2  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Open journal
2. Navigate to Prompts tab
3. Open Mindful AI Assistant
4. Ask a question about journaling
5. Receive AI response

**Expected Results:**
- AI assistant interface opens
- Can send text questions
- Receives relevant, helpful responses
- Uses Lovable AI (no external API key needed)
- Responses appropriate for user's age group

**Actual Results:**
- [ ] Interface works
- [ ] Responses received
- [ ] Content appropriate

---

### Test Case 3.10: Journal Privacy (Minors)
**Priority:** P0  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Login as minor (child/teen)
2. Navigate to journal
3. Check for privacy notice
4. Verify parent journal viewer access

**Expected Results:**
- Privacy notice displayed to minors
- Notice explains parent/guardian may view entries
- Parent can access `/family/journal-viewer` to see child's entries
- RLS policies enforce parent-child relationship

**Actual Results:**
- [ ] Notice displayed
- [ ] Parent viewer works
- [ ] RLS policies enforce access

---

## 4. Chat & User Moderation (P0)

### Test Case 4.1: Join Chat Room by Focus Area
**Priority:** P0  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Navigate to `/chat-rooms`
2. Select focus area (e.g., "Depression Recovery")
3. Click to join room
4. Verify room loads

**Expected Results:**
- Chat rooms list displayed by focus area
- Clicking room navigates to `/chat-room/{roomId}`
- Or `/chat-room/focus/{focusArea}` creates/finds room
- Room created for user's age group if doesn't exist
- Badge shows "Moderated by VibeOps AI"

**Actual Results:**
- [ ] Rooms list loads
- [ ] Room navigation works
- [ ] Age-appropriate room joined
- [ ] Badge displayed

**Analytics Event:** `room_joined`

---

### Test Case 4.2: Send Chat Message
**Priority:** P0  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Join any chat room
2. Type message (under 500 chars)
3. Click Send or press Enter
4. Verify message appears

**Expected Results:**
- Message input field available
- Character counter shows (500 max)
- Message sent to edge function for profanity check
- If clean, appears in chat immediately
- Realtime update for all users in room

**Actual Results:**
- [ ] Message sends
- [ ] Appears in chat
- [ ] Realtime works

**Analytics Event:** `message_sent`

---

### Test Case 4.3: Profanity Filter (Moderate)
**Priority:** P0  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Type message with mild profanity
2. Send message
3. Check what appears in chat

**Expected Results:**
- Edge function `check-profanity` invoked
- Moderate profanity auto-sanitized (replaced with ***)
- Toast: "Content Modified. Some words were replaced..."
- Sanitized message appears in chat

**Actual Results:**
- [ ] Filter triggered
- [ ] Message sanitized
- [ ] Toast shown
- [ ] Sanitized version posted

---

### Test Case 4.4: Profanity Filter (Severe)
**Priority:** P0  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Type message with severe profanity/hate speech
2. Attempt to send

**Expected Results:**
- Edge function rejects with `severity: 'severe'`
- Toast: "Message Rejected. Your message contains inappropriate content..."
- Message NOT posted to chat
- Incident may be logged for moderation review

**Actual Results:**
- [ ] Message blocked
- [ ] Error toast shown
- [ ] No post in chat

---

### Test Case 4.5: Mute User
**Priority:** P1  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. In chat room, click ‚ãÆ menu on another user's message
2. Select "Mute User"
3. Confirm action

**Expected Results:**
- User added to `mutedUsers` set (local state)
- Future messages from that user hidden
- Toast: "User muted. You won't see messages from this user anymore."
- Other users still see muted user's messages

**Actual Results:**
- [ ] Mute button works
- [ ] Messages hidden
- [ ] Toast shown

**Analytics Event:** `room_mute`

---

### Test Case 4.6: Report Message
**Priority:** P0  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. In chat room, click ‚ãÆ menu on message
2. Select "Report Message"
3. Confirm report

**Expected Results:**
- Confirmation dialog appears
- Incident created in `incidents` table
- Fields: room_id, message_id, user_id, category, severity, status="open"
- Toast: "Report submitted. Thank you. Our moderation team will review this."

**Actual Results:**
- [ ] Report dialog works
- [ ] Incident created
- [ ] Toast shown

**Analytics Event:** `room_report`

---

### Test Case 4.7: Block User
**Priority:** P1  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. In chat room, open user menu
2. Click "Block User" button
3. Confirm in alert dialog

**Expected Results:**
- Confirmation dialog: "Are you sure you want to block {username}?"
- Record added to `blocked_users` table
- Blocked user's messages hidden in all rooms
- Cannot see blocked user in other contexts
- Toast: "User blocked successfully"

**Actual Results:**
- [ ] Block dialog works
- [ ] Record created
- [ ] Messages hidden
- [ ] Toast shown

---

### Test Case 4.8: View Blocked Users List
**Priority:** P1  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Block 2+ users
2. Navigate to Settings > Privacy
3. Scroll to Blocked Users List

**Expected Results:**
- List of blocked users displayed
- Each entry shows username
- Unblock button available
- Unblocking removes from `blocked_users` table

**Actual Results:**
- [ ] List displays
- [ ] Unblock works
- [ ] Database updated

---

### Test Case 4.9: Chat Room Presence
**Priority:** P2  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Join chat room
2. Check "active users" count
3. Open room in another browser/device
4. Verify count increases

**Expected Results:**
- Badge shows "{N} active" users
- Presence tracked via `useChatRoomPresence` hook
- Count updates in realtime
- Presence expires after inactivity

**Actual Results:**
- [ ] Count displayed
- [ ] Updates in realtime
- [ ] Multiple devices counted

---

### Test Case 4.10: Chat Subscription Guard
**Priority:** P0  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Login as free user (no subscription)
2. Navigate to `/chat-rooms`
3. Attempt to join room

**Expected Results:**
- RPC `has_chat_access` returns false
- Toast: "Chat requires a subscription. Start a free trial..."
- Redirect to `/chat-rooms` (no access to room)
- Admin users bypass this check

**Actual Results:**
- [ ] Access denied
- [ ] Toast shown
- [ ] Redirect works
- [ ] Admin bypass works

---

### Test Case 4.11: Chat Onboarding (First Time)
**Priority:** P2  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. First time accessing chat
2. Check for onboarding modal
3. Read community guidelines
4. Dismiss onboarding

**Expected Results:**
- Onboarding modal appears once
- Shows "Rules" chip for Community Guidelines
- User must acknowledge before accessing chat
- Modal doesn't reappear after acknowledgment

**Actual Results:**
- [ ] Modal shown once
- [ ] Guidelines clear
- [ ] Doesn't reappear

---

### Test Case 4.12: Realtime Message Updates
**Priority:** P0  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Open chat room in Browser A
2. Send message from Browser B (same room)
3. Verify message appears in Browser A

**Expected Results:**
- Supabase Realtime subscription active
- New messages appear instantly (<1 second)
- No page refresh required
- Auto-scrolls to bottom

**Actual Results:**
- [ ] Message appears instantly
- [ ] No refresh needed
- [ ] Auto-scroll works

---

### Test Case 4.13: Message Length Limit
**Priority:** P1  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Type message >500 characters
2. Attempt to send

**Expected Results:**
- Input enforces MAX_MESSAGE_LENGTH (500)
- Character counter shows "XXX/500"
- Cannot send message over limit
- Error or visual indicator shown

**Actual Results:**
- [ ] Limit enforced
- [ ] Counter accurate
- [ ] Cannot exceed

---

### Test Case 4.14: Chat Rules Chip Click
**Priority:** P2  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. In any chat room
2. Click "Rules" badge/chip in header
3. Verify navigation

**Expected Results:**
- Clicking badge navigates to `/legal/community-guidelines`
- Guidelines page loads
- Can return to chat after reading

**Actual Results:**
- [ ] Navigation works
- [ ] Guidelines load
- [ ] Return works

---

### Test Case 4.15: Empty Room State
**Priority:** P2  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Create or join brand new room
2. View empty room state

**Expected Results:**
- Empty state message shown
- Icon and text: "No messages yet"
- Encouragement: "Be the first to start the conversation!"

**Actual Results:**
- [ ] Empty state displays
- [ ] Messaging encouraging

---

## 5. Store & Subscriptions (P0)

### Test Case 5.1: Browse Store by Age Group
**Priority:** P0  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Navigate to `/store`
2. View age group categories (Kids/Teens/Adults/Elders)
3. Click any category
4. View products

**Expected Results:**
- 4 age group cards displayed
- Each card shows title, description, thumbnail previews
- Clicking card navigates to `/store/{ageGroup}`
- Product list filtered by selected age group

**Actual Results:**
- [ ] Age groups display
- [ ] Navigation works
- [ ] Products filtered correctly

**Analytics Event:** `store_visited`

---

### Test Case 5.2: View Product Detail
**Priority:** P0  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. From age group store page
2. Click on any product card
3. View product detail page

**Expected Results:**
- Navigate to `/product/{productId}`
- Shows product images, title, description
- Displays price
- "Add to Cart" button visible
- Age group badge shown

**Actual Results:**
- [ ] Detail page loads
- [ ] All info displayed
- [ ] Add to cart visible

**Analytics Event:** `product_viewed`

---

### Test Case 5.3: Add to Cart
**Priority:** P0  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. View product detail
2. Click "Add to Cart"
3. Navigate to `/cart`

**Expected Results:**
- Product added to cart (localStorage or state)
- Cart badge/count updates
- Toast: "Added to cart"
- Cart page shows product with quantity, price

**Actual Results:**
- [ ] Item added
- [ ] Count updates
- [ ] Toast shown
- [ ] Cart displays correctly

---

### Test Case 5.4: Checkout with Stripe (One-Time)
**Priority:** P0  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Add product to cart
2. Click "Checkout"
3. Edge function creates Stripe session
4. Redirect to Stripe Checkout
5. Complete payment with test card

**Test Card:** `4242 4242 4242 4242` (Expires: any future date, CVC: any 3 digits)

**Expected Results:**
- Edge function `create-product-checkout` called
- Checkout session URL returned
- Stripe Checkout page opens
- Can complete payment
- Redirect to success page

**Actual Results:**
- [ ] Checkout session created
- [ ] Stripe page loads
- [ ] Payment succeeds
- [ ] Redirect works

**Analytics Event:** `purchase_succeeded`

---

### Test Case 5.5: Subscription Flow (Free Trial)
**Priority:** P0  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. As free user, navigate to Premium features
2. Click "Start Free Trial" or similar
3. Edge function `create-checkout` called with subscription mode
4. Complete Stripe Checkout
5. Verify subscription active

**Expected Results:**
- Stripe session mode: "subscription"
- Subscription created with 7-day trial
- User profile updated with subscription_status
- Access granted to premium features (chat, etc.)

**Actual Results:**
- [ ] Trial starts
- [ ] Subscription active
- [ ] Features unlocked

**Analytics Event:** `subscription_started`

---

### Test Case 5.6: Check Subscription Status
**Priority:** P0  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Login as subscribed user
2. Dashboard auto-invokes `check-subscription` edge function
3. Verify status displayed

**Expected Results:**
- Edge function returns subscription status
- product_id identifies tier (Individual/Family)
- subscription_end date shown
- Badge on dashboard: "Subscribed" or "Free Trial"

**Actual Results:**
- [ ] Status check works
- [ ] Tier identified
- [ ] Badge displayed

---

### Test Case 5.7: Customer Portal (Manage Subscription)
**Priority:** P1  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. As subscribed user
2. Dashboard > Click "Manage" button
3. Edge function `customer-portal` opens Stripe portal
4. View/cancel subscription

**Expected Results:**
- Stripe Customer Portal opens in new tab
- Can view subscription details
- Can cancel subscription
- Can update payment method
- Return URL brings back to app

**Actual Results:**
- [ ] Portal opens
- [ ] Can view details
- [ ] Can cancel
- [ ] Can update payment

**Analytics Event:** `subscription_managed`

---

### Test Case 5.8: Subscription Required for Chat
**Priority:** P0  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Login as free user
2. Navigate to `/chat-rooms`
3. Attempt to join room

**Expected Results:**
- Check via RPC `has_chat_access`
- Returns false for free users
- Toast: "Chat requires a subscription"
- Redirect or block access

**Actual Results:**
- [ ] Access check works
- [ ] Free users blocked
- [ ] Toast shown

---

### Test Case 5.9: Order History
**Priority:** P1  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Complete 2+ product purchases
2. Navigate to `/orders`
3. View order history

**Expected Results:**
- List of past orders displayed
- Each order shows: date, items, total, status
- Can click to view details
- Can request refund if eligible

**Actual Results:**
- [ ] Orders listed
- [ ] Details accurate
- [ ] Refund option (if eligible)

---

### Test Case 5.10: Refund Request
**Priority:** P2  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. From order history, select recent order
2. Click "Request Refund"
3. Submit refund request

**Expected Results:**
- Refund edge function called
- Stripe refund processed
- Order status updated to "refunded"
- User notified via toast

**Actual Results:**
- [ ] Refund initiated
- [ ] Status updated
- [ ] User notified

**Analytics Event:** `refund_requested`

---

### Test Case 5.11: Store Product Admin Management
**Priority:** P1 (Admin)  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Login as admin
2. Navigate to `/admin/products`
3. Create new product
4. Set price, age group, images
5. Activate product

**Expected Results:**
- Admin can CRUD products
- New products appear in store immediately
- Age group filtering works
- Images upload to Supabase Storage

**Actual Results:**
- [ ] CRUD operations work
- [ ] Products appear
- [ ] Images upload

---

### Test Case 5.12: Stripe Live Mode Verification
**Priority:** P0 (Admin)  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Login as admin
2. Navigate to Settings > Security or Admin Dashboard
3. View Stripe Live Mode Status
4. Verify toggle state

**Expected Results:**
- Shows STRIPE_LIVE_MODE environment variable
- Displays "TEST" or "LIVE" mode clearly
- Warning shown if in test mode on production

**Actual Results:**
- [ ] Mode displayed
- [ ] Warning shown (if test)

---

## 6. Account Management (P1)

### Test Case 6.1: Update Profile Fields
**Priority:** P1  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Navigate to Settings > Profile
2. Update username, birthday, timezone
3. Save changes

**Expected Results:**
- Form shows current values
- Can update and save
- Changes persist in `profiles` table
- Toast: "Profile updated"

**Actual Results:**
- [ ] Form pre-filled
- [ ] Updates save
- [ ] Toast shown

---

### Test Case 6.2: Change Language
**Priority:** P1  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Settings > Language
2. Select different language (EN/ES/FR/AR)
3. Confirm change

**Expected Results:**
- Language selector shows current language
- Can select from 4 options
- UI updates immediately to new language
- Language saved to profile

**Actual Results:**
- [ ] Selector works
- [ ] UI updates
- [ ] Language persists

---

### Test Case 6.3: Enable/Disable Push Notifications
**Priority:** P1  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Settings > Notifications
2. Toggle "Push Notifications"
3. If enabling, grant browser permission

**Expected Results:**
- Toggle works
- Browser permission prompt if enabling
- Subscription created/deleted in `push_subscriptions` table
- Test notification button sends test

**Actual Results:**
- [ ] Toggle works
- [ ] Permission requested
- [ ] Subscription saved

---

### Test Case 6.4: Daily Notification Settings
**Priority:** P1  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Settings > Notifications > Daily Notifications
2. Enable daily reminders
3. Set preferred time
4. Save settings

**Expected Results:**
- Can enable/disable
- Time picker shows
- Settings saved to DB
- Cron job sends notifications at set time

**Actual Results:**
- [ ] Enable/disable works
- [ ] Time picker functional
- [ ] Settings persist

---

### Test Case 6.5: Data Export Request
**Priority:** P1  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Settings > Privacy > Data Rights
2. Click "Request Data Export"
3. Confirm request

**Expected Results:**
- Edge function `data-export-request` called
- Email sent with download link
- Export includes all user data (profile, checkins, journal, messages)
- GDPR/CCPA compliant

**Actual Results:**
- [ ] Request submitted
- [ ] Email received
- [ ] Data complete

**Analytics Event:** `data_export_requested`

---

### Test Case 6.6: Account Deletion
**Priority:** P0  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Settings > Privacy > Data Rights
2. Click "Delete Account"
3. Confirm deletion (requires re-entering password)
4. Submit

**Expected Results:**
- Confirmation dialog with warning
- Edge function `execute-account-deletion` called
- Deletes: profile, checkins, journal entries, messages, etc.
- Logs out user
- Cannot login with deleted credentials

**Actual Results:**
- [ ] Confirmation dialog works
- [ ] Deletion executes
- [ ] All data removed
- [ ] Cannot re-login

**Analytics Event:** `account_deleted`

---

### Test Case 6.7: Theme Change (Light/Dark/System)
**Priority:** P2  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Settings > Privacy > Appearance
2. Toggle between Light, Dark, System modes
3. Verify theme changes

**Expected Results:**
- Theme updates immediately
- CSS variables switch (HSL colors)
- Persists across sessions
- System mode respects OS preference

**Actual Results:**
- [ ] Theme switches
- [ ] Colors update correctly
- [ ] Persists

---

### Test Case 6.8: Arthur (AI Assistant) Settings
**Priority:** P1  
**Status:** ‚è≥ NOT TESTED

**Steps:**
1. Settings > Arthur
2. Configure Mostapha notifications
3. Enable/disable features
4. Save

**Expected Results:**
- Can toggle Arthur notifications
- Can set preferences for AI suggestions
- Settings saved to user preferences

**Actual Results:**
- [ ] Toggles work
- [ ] Settings save
- [ ] AI behavior updates

---

## Test Execution Notes

### Critical Path (P0) Test Order
1. Authentication (Login/Signup)
2. Onboarding
3. First Check-in ‚Üí Journal redirect
4. Store browsing and checkout
5. Chat room access (with subscription)
6. Account deletion

### Known Issues from Code Review
1. **Safari Private Mode:** Detection present, need to verify error handling
2. **Chat Subscription Guard:** Ensure free users are properly blocked
3. **Profanity Filter:** Verify edge function connectivity and severity levels
4. **Stripe Live Mode:** Confirm environment variable configuration
5. **Realtime Subscriptions:** Check for memory leaks with long-running sessions
6. **MFA Enforcement:** Verify admin users required to enable MFA

### Test Data Requirements
- 10+ test user accounts (various age groups)
- 20+ journal entries per user
- 50+ chat messages across rooms
- 5+ products per age group
- Test Stripe customer IDs

### Edge Function Dependencies
The following edge functions must be deployed and functional:
- `check-subscription`
- `create-checkout`
- `create-product-checkout`
- `customer-portal`
- `check-profanity`
- `data-export-request`
- `execute-account-deletion`
- `mindful-ai-assistant`
- `generate-ai-suggestions`

### Database Tables Required
Ensure RLS policies are correct for:
- `profiles`
- `mood_checkins`
- `journal_entries`
- `chat_rooms`
- `chat_messages`
- `blocked_users`
- `incidents`
- `products`
- `orders`
- `push_subscriptions`
- `user_settings`

---

**Testing Complete:** ‚ùå NOT STARTED  
**Estimated Testing Time:** 8-12 hours  
**Test Environment:** Production (https://2c588c7a-e9e9-4d3f-b2dd-79a1b8546184.lovableproject.com)
