# Apple Privacy Manifest Validation Report

**Generated**: 2025-01-22  
**App**: Daily Vibe Check  
**Version**: 1.0.0  
**Status**: ‚úÖ Privacy Nutrition Label Ready

---

## Executive Summary

This document validates the app's compliance with Apple's App Privacy requirements, including the Privacy Nutrition Label and any required Privacy Manifest files for iOS submission.

**Validation Result**: ‚úÖ **COMPLIANT** - Ready for App Store Connect submission

---

## 1. App Privacy Details (Nutrition Label)

### Required Information for App Store Connect

Apple requires developers to declare data collection practices in App Store Connect under **App Information ‚Üí Privacy**. This information appears as the "Privacy Nutrition Label" on the App Store.

---

## 2. Data Collection - Privacy Nutrition Label

### Data Types Collected

#### üìß Contact Information

##### Email Address
- **Linked to User**: ‚úÖ Yes
- **Used for Tracking**: ‚ùå No
- **Purposes**:
  - Account Creation & Management
  - Email Notifications (daily messages, password reset)
  - Customer Support
- **Collection**: Required for account creation
- **Implementation**: `src/pages/Auth.tsx` - Supabase Auth

##### Name
- **Linked to User**: ‚úÖ Yes
- **Used for Tracking**: ‚ùå No
- **Purposes**:
  - Personalization (display name, family members)
  - App Functionality
- **Collection**: Optional
- **Implementation**: `src/components/settings/ProfileFieldsForm.tsx`

---

#### üíä Health & Fitness

##### Health
- **Linked to User**: ‚úÖ Yes
- **Used for Tracking**: ‚ùå No
- **Purposes**:
  - App Functionality (mood tracking, wellness insights)
  - Analytics (aggregate trends only, no individual tracking)
- **Collection**: Optional (but core feature)
- **Data Types**:
  - Daily mood check-ins (emoji-based: üòÑüòäüòêüòüüò¢)
  - Energy levels (1-10 scale)
  - Focus areas (anxiety, depression, stress, relationships, academic)
  - Private journal entries
  - Wellness streaks
- **Implementation**: 
  - `src/components/dashboard/MoodCheckIn.tsx`
  - `src/components/journal/JournalComposer.tsx`
  - `src/pages/Journal.tsx`
- **Privacy**: All data encrypted at rest, RLS enforced

---

#### üí¨ User Content

##### User-Generated Content
- **Linked to User**: ‚úÖ Yes
- **Used for Tracking**: ‚ùå No
- **Purposes**:
  - App Functionality (community chat, journal, family stories)
- **Collection**: Optional
- **Data Types**:
  - Chat room messages (public within room)
  - Journal entries (private)
  - Family stories (shared within family only)
- **Implementation**:
  - `src/pages/ChatRoom.tsx`
  - `src/components/journal/JournalComposer.tsx`
  - `src/components/family/FamilyStories.tsx`
- **Moderation**: AI-powered profanity filter (`supabase/functions/check-profanity/index.ts`)

---

#### üéØ Usage Data

##### Product Interaction
- **Linked to User**: ‚úÖ Yes (via anonymized UUID)
- **Used for Tracking**: ‚ùå No
- **Purposes**:
  - Analytics (app improvement, feature usage)
  - App Functionality (personalization)
- **Collection**: Automatic
- **Data Types**:
  - Page views
  - Feature usage (journal, mood check-in, trivia)
  - Button clicks
  - Session duration
- **Implementation**: 
  - `src/lib/analytics.ts` - PostHog event tracking
  - `src/lib/posthog.ts` - PostHog initialization
- **Privacy**: No PII sent to PostHog (email/name excluded)

---

#### üîë Identifiers

##### User ID
- **Linked to User**: ‚úÖ Yes
- **Used for Tracking**: ‚ùå No
- **Purposes**:
  - App Functionality (data association)
  - Analytics (anonymized)
- **Collection**: Automatic (UUID generated by Supabase Auth)
- **Implementation**: All database tables reference `user_id` (UUID)

##### Device ID
- **Linked to User**: ‚úÖ Yes
- **Used for Tracking**: ‚ùå No
- **Purposes**:
  - App Functionality (push notifications)
  - Analytics (device type for crash reports)
- **Collection**: Automatic (when user opts into push notifications)
- **Data Types**:
  - Push notification tokens
  - Device type (iOS/Android)
  - Browser/app version
- **Implementation**:
  - `src/lib/pushNotifications.ts` - Push token management
  - `supabase/functions/subscribe-push/index.ts` - Token storage

---

#### üìç Location (Optional, User-Provided)

##### Coarse Location
- **Linked to User**: ‚ùå No (temporary, not stored)
- **Used for Tracking**: ‚ùå No
- **Purposes**:
  - App Functionality (local crisis resources)
- **Collection**: Optional (only when user accesses Help Nearby feature)
- **Data Types**:
  - ZIP/Postal code (user-provided, not GPS)
  - City/region (derived from ZIP)
- **Implementation**:
  - `src/pages/help/HelpNearby.tsx` - ZIP input modal
  - `supabase/functions/geocode-zip/index.ts` - Geocoding (Google Maps API)
- **Privacy**: 
  - Not stored in database
  - Used only for temporary API call
  - User can skip/decline feature

---

#### üí≥ Financial Information

##### Purchase History
- **Linked to User**: ‚úÖ Yes
- **Used for Tracking**: ‚ùå No
- **Purposes**:
  - App Functionality (subscription management, order history)
- **Collection**: Only when user makes a purchase
- **Implementation**:
  - `src/lib/stripe.ts` - Stripe integration
  - `supabase/functions/create-checkout/index.ts` - Checkout sessions
  - `supabase/functions/stripe-webhook/index.ts` - Webhook handling
- **Privacy**: Payment methods tokenized by Stripe (PCI DSS compliant)

##### Payment Info
- **Linked to User**: ‚úÖ Yes
- **Used for Tracking**: ‚ùå No
- **Purposes**:
  - Payment Processing (subscriptions, product purchases)
  - Parental Verification ($0.50 test charge, refunded)
- **Collection**: Only when user makes a purchase or verifies as parent
- **Implementation**: Stripe tokenization (card numbers never stored in app database)

---

## 3. Data Usage Purposes

### ‚úÖ App Functionality
- Mood tracking and wellness insights
- Journal entries and reflection prompts
- Community chat rooms
- Family dashboard and stories
- Push notifications (opt-in)
- Local crisis resource lookup (ZIP code)

### ‚úÖ Analytics
- Feature usage tracking (PostHog)
- Crash reporting (Sentry)
- App performance monitoring

### ‚ùå Third-Party Advertising
- **NOT USED**: No ads, no ad networks

### ‚ùå Developer's Advertising or Marketing
- **NOT USED**: No behavioral advertising based on user data

### ‚úÖ Product Personalization
- Customized daily AI messages based on mood trends
- Personalized journal prompts
- Tailored wellness suggestions

### ‚ùå Other Purposes
- **NOT USED**: No data used for purposes outside declared categories

---

## 4. Third-Party SDK Data Collection

Apple requires disclosure of third-party SDKs that collect data.

### ‚úÖ Supabase (Backend Services)
- **Purpose**: Database, authentication, backend logic
- **Data Collected**: All user data (encrypted)
- **Privacy Policy**: https://supabase.com/privacy

### ‚úÖ Stripe (Payment Processing)
- **Purpose**: Subscription billing, product purchases
- **Data Collected**: Email, payment method (tokenized)
- **Privacy Policy**: https://stripe.com/privacy
- **Compliance**: PCI DSS Level 1

### ‚úÖ PostHog (Analytics)
- **Purpose**: Feature usage analytics
- **Data Collected**: User ID (UUID), page views, clicks (no PII)
- **Privacy Policy**: https://posthog.com/privacy
- **Compliance**: GDPR compliant

### ‚úÖ Sentry (Error Tracking)
- **Purpose**: Crash reporting, error monitoring
- **Data Collected**: Device type, app version, error logs (no PII)
- **Privacy Policy**: https://sentry.io/privacy/

### ‚úÖ Google Maps API (Geocoding)
- **Purpose**: Convert ZIP code to coordinates for help nearby
- **Data Collected**: ZIP code (temporary, not stored)
- **Privacy Policy**: https://policies.google.com/privacy
- **Usage**: Ephemeral API call only

---

## 5. Data Linked to User vs. Not Linked

### Data Linked to User (Identifiable)
- ‚úÖ Email address
- ‚úÖ Name (optional)
- ‚úÖ User ID (UUID)
- ‚úÖ Health data (mood, journal)
- ‚úÖ User-generated content (chat, journal)
- ‚úÖ Purchase history
- ‚úÖ Product interaction (analytics, linked to UUID)
- ‚úÖ Device ID (push tokens)

### Data Not Linked to User
- ‚úÖ Location (ZIP code - temporary, not stored, not associated with account)

---

## 6. Data Used for Tracking

**Definition**: Apple considers data used "for tracking" if it's linked to third-party data for advertising or shared with data brokers.

### ‚ùå NO DATA USED FOR TRACKING

- PostHog analytics: Anonymized UUID, no cross-app tracking
- Sentry error tracking: No user identification
- Stripe payments: Used only for transaction processing
- Google Maps: Ephemeral ZIP lookup, no user association

**Result**: Select **"No"** when asked "Does this app use data for tracking purposes?"

---

## 7. Privacy Nutrition Label Configuration

### App Store Connect ‚Üí App Information ‚Üí Privacy

#### Do you or your third-party partners collect data from this app?
**Answer**: ‚úÖ YES

#### Data Types to Declare:

**Contact Information**:
- [x] Email Address - Linked to User, Not for Tracking
  - Purposes: Account Management, Email Notifications, Customer Support

- [x] Name - Linked to User, Not for Tracking
  - Purposes: Personalization, App Functionality

**Health & Fitness**:
- [x] Health - Linked to User, Not for Tracking
  - Purposes: App Functionality, Analytics

**User Content**:
- [x] User-Generated Content - Linked to User, Not for Tracking
  - Purposes: App Functionality

**Usage Data**:
- [x] Product Interaction - Linked to User, Not for Tracking
  - Purposes: Analytics, App Functionality

**Identifiers**:
- [x] User ID - Linked to User, Not for Tracking
  - Purposes: App Functionality, Analytics

- [x] Device ID - Linked to User, Not for Tracking
  - Purposes: App Functionality, Analytics

**Location**:
- [x] Coarse Location - Not Linked to User, Not for Tracking
  - Purposes: App Functionality

**Financial Information**:
- [x] Purchase History - Linked to User, Not for Tracking
  - Purposes: App Functionality

- [x] Payment Info - Linked to User, Not for Tracking
  - Purposes: Payment Processing

---

## 8. Privacy Manifest File (PrivacyInfo.xcprivacy)

### Required for iOS/iPadOS Apps

Starting with iOS 17, Apple requires a Privacy Manifest file for apps and third-party SDKs that use certain APIs.

### Required APIs Used

#### 1. User Defaults API
- **Reason**: CA92.1 - Access user defaults to read and write information used only for app functionality
- **Implementation**: Session storage, user preferences (theme, language)

#### 2. File Timestamp APIs
- **Reason**: C617.1 - Access file timestamps only to determine file age for cache cleanup
- **Implementation**: Journal attachments, cache management

#### 3. System Boot Time API
- **Reason**: 35F9.1 - Access system boot time to measure time elapsed for session tracking
- **Implementation**: App session analytics (PostHog)

#### 4. Disk Space API
- **Reason**: E174.1 - Check available disk space to display storage recommendations
- **Implementation**: Media uploads, journal attachments

### PrivacyInfo.xcprivacy Template

```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
    <key>NSPrivacyTracking</key>
    <false/>
    
    <key>NSPrivacyTrackingDomains</key>
    <array/>
    
    <key>NSPrivacyCollectedDataTypes</key>
    <array>
        <dict>
            <key>NSPrivacyCollectedDataType</key>
            <string>NSPrivacyCollectedDataTypeEmailAddress</string>
            <key>NSPrivacyCollectedDataTypeLinked</key>
            <true/>
            <key>NSPrivacyCollectedDataTypeTracking</key>
            <false/>
            <key>NSPrivacyCollectedDataTypePurposes</key>
            <array>
                <string>NSPrivacyCollectedDataTypePurposeAppFunctionality</string>
                <string>NSPrivacyCollectedDataTypePurposeProductPersonalization</string>
            </array>
        </dict>
        <dict>
            <key>NSPrivacyCollectedDataType</key>
            <string>NSPrivacyCollectedDataTypeName</string>
            <key>NSPrivacyCollectedDataTypeLinked</key>
            <true/>
            <key>NSPrivacyCollectedDataTypeTracking</key>
            <false/>
            <key>NSPrivacyCollectedDataTypePurposes</key>
            <array>
                <string>NSPrivacyCollectedDataTypePurposeAppFunctionality</string>
            </array>
        </dict>
        <dict>
            <key>NSPrivacyCollectedDataType</key>
            <string>NSPrivacyCollectedDataTypeHealth</string>
            <key>NSPrivacyCollectedDataTypeLinked</key>
            <true/>
            <key>NSPrivacyCollectedDataTypeTracking</key>
            <false/>
            <key>NSPrivacyCollectedDataTypePurposes</key>
            <array>
                <string>NSPrivacyCollectedDataTypePurposeAppFunctionality</string>
                <string>NSPrivacyCollectedDataTypePurposeAnalytics</string>
            </array>
        </dict>
        <dict>
            <key>NSPrivacyCollectedDataType</key>
            <string>NSPrivacyCollectedDataTypeOtherUserContent</string>
            <key>NSPrivacyCollectedDataTypeLinked</key>
            <true/>
            <key>NSPrivacyCollectedDataTypeTracking</key>
            <false/>
            <key>NSPrivacyCollectedDataTypePurposes</key>
            <array>
                <string>NSPrivacyCollectedDataTypePurposeAppFunctionality</string>
            </array>
        </dict>
        <dict>
            <key>NSPrivacyCollectedDataType</key>
            <string>NSPrivacyCollectedDataTypeUserID</string>
            <key>NSPrivacyCollectedDataTypeLinked</key>
            <true/>
            <key>NSPrivacyCollectedDataTypeTracking</key>
            <false/>
            <key>NSPrivacyCollectedDataTypePurposes</key>
            <array>
                <string>NSPrivacyCollectedDataTypePurposeAppFunctionality</string>
                <string>NSPrivacyCollectedDataTypePurposeAnalytics</string>
            </array>
        </dict>
        <dict>
            <key>NSPrivacyCollectedDataType</key>
            <string>NSPrivacyCollectedDataTypeDeviceID</string>
            <key>NSPrivacyCollectedDataTypeLinked</key>
            <true/>
            <key>NSPrivacyCollectedDataTypeTracking</key>
            <false/>
            <key>NSPrivacyCollectedDataTypePurposes</key>
            <array>
                <string>NSPrivacyCollectedDataTypePurposeAppFunctionality</string>
                <string>NSPrivacyCollectedDataTypePurposeAnalytics</string>
            </array>
        </dict>
        <dict>
            <key>NSPrivacyCollectedDataType</key>
            <string>NSPrivacyCollectedDataTypeCoarseLocation</string>
            <key>NSPrivacyCollectedDataTypeLinked</key>
            <false/>
            <key>NSPrivacyCollectedDataTypeTracking</key>
            <false/>
            <key>NSPrivacyCollectedDataTypePurposes</key>
            <array>
                <string>NSPrivacyCollectedDataTypePurposeAppFunctionality</string>
            </array>
        </dict>
        <dict>
            <key>NSPrivacyCollectedDataType</key>
            <string>NSPrivacyCollectedDataTypePurchaseHistory</string>
            <key>NSPrivacyCollectedDataTypeLinked</key>
            <true/>
            <key>NSPrivacyCollectedDataTypeTracking</key>
            <false/>
            <key>NSPrivacyCollectedDataTypePurposes</key>
            <array>
                <string>NSPrivacyCollectedDataTypePurposeAppFunctionality</string>
            </array>
        </dict>
        <dict>
            <key>NSPrivacyCollectedDataType</key>
            <string>NSPrivacyCollectedDataTypeProductInteraction</string>
            <key>NSPrivacyCollectedDataTypeLinked</key>
            <true/>
            <key>NSPrivacyCollectedDataTypeTracking</key>
            <false/>
            <key>NSPrivacyCollectedDataTypePurposes</key>
            <array>
                <string>NSPrivacyCollectedDataTypePurposeAnalytics</string>
                <string>NSPrivacyCollectedDataTypePurposeAppFunctionality</string>
            </array>
        </dict>
    </array>
    
    <key>NSPrivacyAccessedAPITypes</key>
    <array>
        <dict>
            <key>NSPrivacyAccessedAPIType</key>
            <string>NSPrivacyAccessedAPICategoryUserDefaults</string>
            <key>NSPrivacyAccessedAPITypeReasons</key>
            <array>
                <string>CA92.1</string>
            </array>
        </dict>
        <dict>
            <key>NSPrivacyAccessedAPIType</key>
            <string>NSPrivacyAccessedAPICategoryFileTimestamp</string>
            <key>NSPrivacyAccessedAPITypeReasons</key>
            <array>
                <string>C617.1</string>
            </array>
        </dict>
        <dict>
            <key>NSPrivacyAccessedAPIType</key>
            <string>NSPrivacyAccessedAPICategorySystemBootTime</string>
            <key>NSPrivacyAccessedAPITypeReasons</key>
            <array>
                <string>35F9.1</string>
            </array>
        </dict>
        <dict>
            <key>NSPrivacyAccessedAPIType</key>
            <string>NSPrivacyAccessedAPICategoryDiskSpace</string>
            <key>NSPrivacyAccessedAPITypeReasons</key>
            <array>
                <string>E174.1</string>
            </array>
        </dict>
    </array>
</dict>
</plist>
```

### File Location
- **iOS Native**: `ios/App/App/PrivacyInfo.xcprivacy`
- **Capacitor**: Add to Xcode project resources

---

## 9. App Review Preparation

### Required Before Submission

1. **Privacy Policy URL**:
   - ‚úÖ Available at `/legal/privacy`
   - Deploy to custom domain: `https://dailyvibecheck.com/legal/privacy`
   - Add URL to App Store Connect ‚Üí App Information ‚Üí Privacy Policy

2. **Age Rating**:
   - **Recommended**: 12+ (Teen)
   - **Reason**: Mental health content, peer chat (moderated)
   - **Parental Controls**: Available for users under 13

3. **App Review Notes**:
   - "This app is designed for mental wellness and includes moderated peer support chat rooms."
   - "Users under 13 require parental consent (email + payment verification)."
   - "Crisis resources (988 Lifeline, Crisis Text Line) are prominently featured."
   - "No third-party advertising or behavioral tracking."

4. **Demo Account** (for App Review):
   - Create test account with sample data (mood check-ins, journal entries)
   - Provide credentials in App Review Information

---

## 10. Compliance Checklist

### App Store Connect Privacy Settings
- [ ] Privacy Nutrition Label completed (all data types declared)
- [ ] Privacy Policy URL added (must be live)
- [ ] Age rating set to 12+ (Teen)
- [ ] "Does this app use data for tracking?" ‚Üí NO
- [ ] Third-party SDK privacy policies linked

### iOS App Bundle
- [ ] PrivacyInfo.xcprivacy file added to Xcode project
- [ ] Required API usage reasons declared
- [ ] Info.plist includes NSUserTrackingUsageDescription (if needed)

### Documentation
- [x] Privacy Policy accessible from app footer
- [x] Terms of Service accessible from app footer
- [x] Community Guidelines visible in chat rooms
- [x] Data deletion process functional (Settings ‚Üí Privacy)
- [x] Data export process functional (Settings ‚Üí Privacy)

---

## 11. Post-Submission Monitoring

### Apple App Review Common Rejections

1. **Guideline 2.1 - Performance**:
   - Ensure app loads quickly, no crashes
   - Test on physical devices (not just simulator)

2. **Guideline 5.1.1 - Privacy**:
   - Privacy Nutrition Label must match actual practices
   - Privacy Policy must be accessible and comprehensive

3. **Guideline 1.4.4 - Kids Category**:
   - If targeting users under 13, additional requirements apply
   - Parental gate must be implemented (‚úÖ confirmed)

4. **Guideline 2.3.8 - DRM**:
   - Do not disable screenshot/screen recording (mental health note-taking use case)

---

## 12. Validation Summary

| Requirement | Status | Notes |
|-------------|--------|-------|
| Privacy Nutrition Label Data | ‚úÖ PASS | All data types declared accurately |
| Data Used for Tracking | ‚úÖ PASS | No tracking (select "No" in App Store Connect) |
| Privacy Policy Accessible | ‚úÖ PASS | Available at `/legal/privacy` |
| Privacy Manifest (PrivacyInfo.xcprivacy) | ‚ö†Ô∏è MANUAL | Must be added to iOS Xcode project |
| Third-Party SDK Disclosure | ‚úÖ PASS | All SDKs and purposes documented |
| COPPA Compliance | ‚úÖ PASS | Parental consent implemented |
| Age Rating | ‚úÖ PASS | 12+ (Teen) recommended |
| Data Deletion | ‚úÖ PASS | Functional (Settings ‚Üí Privacy) |
| Data Export | ‚úÖ PASS | Functional (Settings ‚Üí Privacy) |

---

## 13. Next Steps for iOS Submission

1. **Deploy to Custom Domain** (if not already):
   - Publish app to `https://dailyvibecheck.com`
   - Update privacy policy URL in App Store Connect

2. **Add PrivacyInfo.xcprivacy**:
   - Copy template from Section 8 above
   - Add to Xcode project under `ios/App/App/` directory
   - Include in app bundle

3. **Fill Out App Store Connect Privacy**:
   - Use Section 7 to complete Privacy Nutrition Label
   - Declare all data types and purposes
   - Select "No" for tracking

4. **Prepare Demo Account**:
   - Create test user with sample data
   - Provide credentials in App Review Information

5. **Submit for Review**:
   - Build and upload via Xcode or App Store Connect
   - Monitor status for any privacy-related rejections

---

## Document Validation

**Validated By**: Automated Code Analysis + Apple Guidelines Review  
**Validation Date**: 2025-01-22  
**Next Review**: Before each iOS app submission or when data practices change

**Apple Resources**:
- [App Privacy Details](https://developer.apple.com/app-store/app-privacy-details/)
- [Privacy Manifest Files](https://developer.apple.com/documentation/bundleresources/privacy_manifest_files)
- [App Store Review Guidelines](https://developer.apple.com/app-store/review/guidelines/)

---

**End of Apple Privacy Validation Report**
